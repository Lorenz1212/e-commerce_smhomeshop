import{b as L,c as w,S as v,d as A,e as S,m as D,r as B,g as k,j as e,i as M,a as C,t as I,n as E,C as T,K as P,P as H}from"./index-47a86244.js";import{M as K}from"./ModalHandler-ad0ee9b4.js";import{a as _}from"./apiMultipart-5aee4e22.js";import{M as F}from"./MulitpleImageUploader-3f05f02e.js";import{D as $,A as q}from"./ActionsCell-25d0eec8.js";import{I as V}from"./ImageTitleCell-2b5fa3f1.js";const y=()=>{const{showLoader:i,hideLoader:a}=L();return{viewProductBrandDetails:async o=>{var t,n;try{return i(),(await w.get(`/admin/product_brand/${o}/edit`)).data}catch(l){return v.fire({icon:"error",title:(n=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:n.message}),null}finally{a()}},createProductBrand:async(o,t,n,l)=>{var u,c,d,r,h;try{i();const b=new FormData;["name"].forEach(j=>b.append(j,o[j])),o.images.forEach(j=>{b.append("images[]",j)});const N=await _.post("/admin/product_brand/store",b);v.fire({icon:(u=N.data)==null?void 0:u.status,title:(c=N.data)==null?void 0:c.message}),((d=N.data)==null?void 0:d.status)=="success"&&(t(),n==null||n(!0),l==null||l(1))}catch(b){v.fire({icon:"error",title:(h=(r=b==null?void 0:b.response)==null?void 0:r.data)==null?void 0:h.message})}finally{a()}},updateProductBrand:async(o,t,n)=>{var l,u,c,d;try{i();const r=new FormData;["name"].forEach(f=>r.append(f,o[f])),o.images.forEach(f=>{r.append("images[]",f)});const b=await _.post(`/admin/product_brand/${t}/update`,r);v.fire({icon:(l=b.data)==null?void 0:l.status,title:(u=b.data)==null?void 0:u.message}),n==null||n(!0)}catch(r){console.log(r),v.fire({icon:"error",title:(d=(c=r==null?void 0:r.response)==null?void 0:c.data)==null?void 0:d.message})}finally{a()}},archivedProductBrand:async(o,t)=>{var l,u,c,d;if((await v.fire({title:"Are you sure?",text:"This action will archive the item.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, archive it!"})).isConfirmed)try{i();const r=await w.delete(`/admin/product_brand/${o}/delete`);v.fire({icon:((l=r.data)==null?void 0:l.status)||"success",title:(u=r.data)==null?void 0:u.message}),t==null||t(!0)}catch(r){v.fire({icon:"error",title:((d=(c=r==null?void 0:r.response)==null?void 0:c.data)==null?void 0:d.message)||"An error occurred."})}finally{a()}},restoreProductBrand:async(o,t,n)=>{var u,c,d,r;if((await v.fire({title:"Are you sure?",text:"This will restore the archived item.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, restore it!"})).isConfirmed)try{i();const h=await w.post(`/admin/product_brand/${o}/restore`);v.fire({icon:((u=h.data)==null?void 0:u.status)||"success",title:((c=h.data)==null?void 0:c.message)||"Item restored successfully."}),t==null||t(!0),n==null||n(!0)}catch(h){v.fire({icon:"error",title:((r=(d=h==null?void 0:h.response)==null?void 0:d.data)==null?void 0:r.message)||"Something went wrong."})}finally{a()}}}},Y=A().shape({name:S().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Brand name is required"),images:D().test("required","Image is required",i=>Array.isArray(i)&&i.length>0)}),U=({setPage:i,setRefreshTable:a,onSubmit:p})=>{const[s,g]=B.useState([]),{createProductBrand:x}=y(),m=k({initialValues:{name:"",images:[]},validationSchema:Y,onSubmit:async(o,{resetForm:t})=>{await x(o,t,a,i),p==null||p(o)}});return e.jsxs("form",{noValidate:!0,onSubmit:m.handleSubmit,children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(F,{name:"images",formik:m,previews:s,setPreviews:g,label:"Upload Image",maxFiles:1})}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Brand Name"}),e.jsx("input",{type:"text",className:M("form-control",{"is-invalid":m.touched.name&&m.errors.name}),...m.getFieldProps("name")}),m.touched.name&&m.errors.name&&e.jsx("div",{className:"invalid-feedback",children:m.errors.name})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})},z=({brandID:i,data:a,setRefreshTable:p,onSubmit:s})=>{const{updateProductBrand:g}=y(),[x,m]=B.useState(a!=null&&a.image_cover?[a.image_cover]:[]),o=A().shape({name:S().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Brand name is required"),images:D().test("images","At least one image required",function(n){return Array.isArray(n)&&n.length>0||x&&x.length>0})}),t=k({initialValues:{name:a.name,images:[]},validationSchema:o,onSubmit:async(n,{resetForm:l})=>{await g(n,i,p),s==null||s(n)}});return e.jsxs("form",{noValidate:!0,onSubmit:t.handleSubmit,children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(F,{name:"images",formik:t,previews:x,setPreviews:m,label:"Upload Image",maxFiles:1})}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Brand Name"}),e.jsx("input",{type:"text",className:M("form-control",{"is-invalid":t.touched.name&&t.errors.name}),...t.getFieldProps("name")}),t.touched.name&&typeof t.errors.name=="string"&&e.jsx("div",{className:"invalid-feedback",children:t.errors.name})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})},G=({data:i,loading:a,pagination:p,sortColumn:s,sortDirection:g,onPageChange:x,onSortChange:m,onRestore:o,onSearchChange:t,setRefreshTable:n,setRefreshFirstTable:l})=>{const{currentUser:u}=C(),c=u==null?void 0:u.permissions,d=[{title:"#",key:"row_number",sortable:!0},{title:"Items",key:"image_cover",render:r=>e.jsx(V,{image:r.image_cover??I("media/default.jpg"),mainTitle:r.name})},{title:"Created At",key:"created_at_format",sortable:!0},{title:"Action",key:"id_encrypted",render:r=>e.jsx(q,{restoreAction:c.includes("restore_product_brand")?()=>o(r.id_encrypted,n,l):void 0})}];return e.jsx("div",{className:"table-responsive",children:a?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx($,{data:i,columns:d,loading:a,pagination:p,sortColumn:s,sortDirection:g,onPageChange:x,onSortChange:m,onSearchChange:t})})},J=({onRefreshFirstTable:i})=>{const a=E("/admin/product_brand/archived/list"),{restoreProductBrand:p}=y();return e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(G,{data:a.data,loading:a.loading,pagination:a.pagination,sortColumn:a.sortColumn,sortDirection:a.sortDirection,onPageChange:a.setPage,onSortChange:(s,g)=>{a.setSortColumn(s),a.setSortDirection(g)},onRestore:p,onSearchChange:s=>{a.setPage(1),a.setSearch(s)},setRefreshTable:a.setRefreshTable,setRefreshFirstTable:i})})})},O=({data:i,loading:a,pagination:p,sortColumn:s,sortDirection:g,onPageChange:x,onSortChange:m,onEdit:o,onView:t,onArchive:n,onSearchChange:l,setRefreshTable:u})=>{const{currentUser:c}=C(),d=c==null?void 0:c.permissions,r=[{title:"#",key:"row_number",sortable:!0},{title:"Items",key:"image_cover",render:h=>e.jsx(V,{image:h.image_cover??I("media/default.jpg"),mainTitle:h.name})},{title:"Created At",key:"created_at_format",sortable:!0},{title:"Action",key:"id_encrypted",render:h=>e.jsx(q,{openDetailsModal:d.includes("view_product_brand_details")?()=>t(h.id_encrypted):void 0,openEditModal:d.includes("update_product_brand")?()=>o(h.id_encrypted):void 0,archiveAction:d.includes("archived_product_brand")?()=>n(h.id_encrypted,u):void 0})}];return e.jsx("div",{className:"table-responsive",children:a?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx($,{data:i,columns:r,loading:a,pagination:p,sortColumn:s,sortDirection:g,onPageChange:x,onSortChange:m,onSearchChange:l})})},Q=({data:i})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Product Brand"}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:i.name})]})}),W=({title:i})=>{const{currentUser:a}=C(),p=a==null?void 0:a.permissions,s=E("/admin/product_brand/list"),{viewProductBrandDetails:g,archivedProductBrand:x}=y(),[m,o]=B.useState({visible:!1,title:"",body:e.jsx(e.Fragment,{}),className:"modal-xl",alignment:"centered"}),t=()=>{o({visible:!0,title:`Create ${i}`,body:e.jsx(U,{setPage:s.setPage,setRefreshTable:s.setRefreshTable}),className:"modal-lg",alignment:"centered"})},n=async c=>{const d=await g(c);d&&o({visible:!0,title:`Edit ${i}`,body:e.jsx(z,{brandID:c,data:d,setRefreshTable:s.setRefreshTable}),className:"modal-lg",alignment:"centered"})},l=async c=>{const d=await g(c);d&&o({visible:!0,title:`View ${i} Details`,body:e.jsx(Q,{data:d}),className:"modal-md",alignment:"centered"})},u=async()=>{o({visible:!0,title:"Archived",body:e.jsx(J,{onRefreshFirstTable:s.setRefreshTable}),className:"modal-xl",alignment:"centered"})};return e.jsx(e.Fragment,{children:e.jsxs(T,{children:[e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsx("h3",{className:"card-title align-items-start flex-column",children:e.jsxs("span",{className:"card-label fw-bold fs-3 mb-1",children:[i,"s"]})}),e.jsxs("div",{className:"card-toolbar","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-trigger":"hover",title:"Click to add a user",children:[p.includes("archived_product")&&e.jsxs("button",{onClick:()=>u(),className:"btn btn-sm btn-light-danger me-3",children:[e.jsx(P,{iconName:"delete-files",className:"fs-3"}),"Archived"]}),p.includes("create_product")&&e.jsxs("button",{onClick:()=>t(),className:"btn btn-sm btn-light-primary",children:[e.jsx(P,{iconName:"plus",className:"fs-3"}),"New ",i]})]})]}),e.jsx("div",{className:"card-body py-3",children:e.jsx("div",{className:"table-responsive",children:e.jsx(O,{data:s.data,loading:s.loading,pagination:s.pagination,sortColumn:s.sortColumn,sortDirection:s.sortDirection,onPageChange:s.setPage,onSortChange:(c,d)=>{s.setSortColumn(c),s.setSortDirection(d)},onEdit:n,onView:l,onArchive:x,onSearchChange:c=>{s.setPage(1),s.setSearch(c)},setRefreshTable:s.setRefreshTable})})})]}),m.visible&&e.jsx(K,{title:m.title,body:m.body,modalClass:m.className,alignment:m.alignment,onClose:()=>o({visible:!1,title:"",body:e.jsx(e.Fragment,{}),className:"",alignment:"center"})})]})})},X=[{title:"Product Brand",path:"/product/brands/list",isSeparator:!1,isActive:!1}],re=()=>e.jsxs(e.Fragment,{children:[e.jsx(H,{breadcrumbs:X}),e.jsx(W,{title:"Product Brand"})]});export{re as default};
