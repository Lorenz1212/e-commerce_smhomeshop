import{r as d,j as t,i as N,S}from"./index-716f35f1.js";import{L as C}from"./ImageTitleCell-de4f184b.js";const V=({name:a,formik:l,previews:r,setPreviews:g,label:w="Upload Images",accept:R="image/*",maxFiles:m=5,getPrimaryIndex:L=0})=>{const y=d.useRef(null),[b,h]=d.useState([]),[j,v]=d.useState(null),[i,o]=d.useState(L),U=["image/jpeg","image/jpg","image/png"],F=e=>U.includes(e.type),P=e=>{const s=e.target.files;if(!s)return;const p=Array.from(s),c=p.filter(F);if(c.length<p.length&&S.fire({icon:"info",title:"Only JPG, JPEG, PNG files are allowed."}),m===1){const n=c[0];if(!n)return;r[0]&&URL.revokeObjectURL(r[0]);const u=URL.createObjectURL(n);l.setFieldValue(a,[n]),g([u]),h([100]),o(0)}else{const u=[...l.values[a]||[],...c].slice(0,m);l.setFieldValue(a,u),r.forEach(f=>URL.revokeObjectURL(f));const x=u.map(f=>URL.createObjectURL(f));g(x),h(Array(x.length).fill(100)),i>=x.length&&o(0)}e.target.value=""},I=e=>{const s=[...l.values[a]||[]];s.splice(e,1),l.setFieldValue(a,s);const p=[...r];p.splice(e,1),g(p);const c=[...b];c.splice(e,1),h(c),i===e?o(0):i>e&&o(n=>n-1)};return t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"form-label",children:w}),t.jsx("div",{className:"d-flex flex-wrap gap-2 mb-2",children:r.length>0?r.filter(Boolean).map((e,s)=>t.jsxs("div",{className:N("position-relative image-preview-container image-input-wrapper w-150px h-150px",{"border border-success border-3":s===i}),children:[r.length>1&&t.jsx("button",{type:"button",className:N("btn btn-sm position-absolute top-0 start-0 m-1",s===i?"btn-success":"btn-secondary"),onClick:()=>{o(s),l.setFieldValue("primary_index",s)},children:s===i?"✓ Primary":"Set Primary"}),t.jsx("img",{src:e,alt:`Preview ${s}`,className:"img-thumbnail preview-image",style:{cursor:"pointer"},onClick:()=>v(s)}),t.jsx("div",{className:"progress mt-1",style:{height:"5px"},children:t.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${b[s]||0}%`},"aria-valuenow":b[s]||0,"aria-valuemin":0,"aria-valuemax":100})}),t.jsx("button",{type:"button",className:"btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow remove-button",onClick:()=>I(s),children:"×"})]},s)):t.jsx("div",{className:"position-relative image-preview-container image-input-wrapper w-150px h-150px",children:t.jsx("img",{src:"/media/default.jpg",alt:"Default Preview",className:"img-thumbnail preview-image"})})}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{var e;return(e=y.current)==null?void 0:e.click()},children:"Select Images"}),t.jsx("input",{type:"file",accept:R,onChange:P,ref:y,className:"d-none",multiple:m>1}),l.touched[a]&&l.errors[a]&&t.jsx("div",{className:"invalid-feedback d-block",children:l.errors[a]}),j!==null&&t.jsx(C,{open:j!==null,close:()=>v(null),index:j,slides:r.filter(Boolean).map(e=>({src:e}))})]})};export{V as M};
