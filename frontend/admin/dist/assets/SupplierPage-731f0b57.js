import{b as A,c as g,S as v,d as C,e as j,g as w,j as e,i as f,n as k,r as q,C as F,K as S,P as D}from"./index-716f35f1.js";import{M as E}from"./ModalHandler-0e663310.js";import{P as _}from"./phoneNumber-91d548a9.js";import{D as M,A as P}from"./ActionsCell-1ea9e971.js";const y=()=>{const{showLoader:r,hideLoader:t}=A();return{viewSupplierDetails:async d=>{var o,i;try{return r(),(await g.get(`/admin/supplier/${d}/edit`)).data}catch(l){return v.fire({icon:"error",title:(i=(o=l==null?void 0:l.response)==null?void 0:o.data)==null?void 0:i.message}),null}finally{t()}},createSupplier:async(d,o,i,l)=>{var m,p,u,c,b;try{r();const N=await g.post("/admin/supplier/store",d);v.fire({icon:(m=N.data)==null?void 0:m.status,title:(p=N.data)==null?void 0:p.message}),((u=N.data)==null?void 0:u.status)=="success"&&(o(),i==null||i(!0),l==null||l(1))}catch(N){v.fire({icon:"error",title:(b=(c=N==null?void 0:N.response)==null?void 0:c.data)==null?void 0:b.message})}finally{t()}},updateSupplier:async(d,o,i)=>{var l,m,p,u;try{r();const c=await g.put(`/admin/supplier/${o}/update`,d);v.fire({icon:(l=c.data)==null?void 0:l.status,title:(m=c.data)==null?void 0:m.message}),i==null||i(!0)}catch(c){console.log(c),v.fire({icon:"error",title:(u=(p=c==null?void 0:c.response)==null?void 0:p.data)==null?void 0:u.message})}finally{t()}},archivedSupplier:async(d,o)=>{var l,m,p,u;if((await v.fire({title:"Are you sure?",text:"This action will archive the supplier.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, archive it!"})).isConfirmed)try{r();const c=await g.delete(`/admin/supplier/${d}/delete`);v.fire({icon:((l=c.data)==null?void 0:l.status)||"success",title:((m=c.data)==null?void 0:m.message)||"Supplier archived successfully."}),o==null||o(!0)}catch(c){v.fire({icon:"error",title:((u=(p=c==null?void 0:c.response)==null?void 0:p.data)==null?void 0:u.message)||"An error occurred."})}finally{t()}},restoreSupplier:async(d,o,i)=>{var m,p,u,c;if((await v.fire({title:"Are you sure?",text:"This will restore the archived supplier.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, restore it!"})).isConfirmed)try{r();const b=await g.post(`/admin/supplier/${d}/restore`);v.fire({icon:((m=b.data)==null?void 0:m.status)||"success",title:((p=b.data)==null?void 0:p.message)||"Supplier restored successfully."}),o==null||o(!0),i==null||i(!0)}catch(b){v.fire({icon:"error",title:((c=(u=b==null?void 0:b.response)==null?void 0:u.data)==null?void 0:c.message)||"Something went wrong."})}finally{t()}}}},V=C().shape({name:j().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Supplier name is required"),contact_person:j().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Contact person is required"),phone:j().min(1,"Minimum 1 character").max(30,"Maximum 30 characters").required("Phone number is required"),email:j().email("Invalid email format").max(100,"Maximum 100 characters").required("Email is required")}),B=({setPage:r,setRefreshTable:t,onSubmit:h})=>{const{createSupplier:n}=y(),a=w({initialValues:{name:"",contact_person:"",phone:"",email:""},validationSchema:V,onSubmit:async(s,{resetForm:x})=>{await n(s,x,t,r),h==null||h(s)}});return e.jsxs("form",{className:"form",noValidate:!0,onSubmit:a.handleSubmit,children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Supplier Name"}),e.jsx("input",{type:"text",className:f("form-control",{"is-invalid":a.touched.name&&a.errors.name}),...a.getFieldProps("name")}),a.touched.name&&a.errors.name&&e.jsx("div",{className:"invalid-feedback",children:a.errors.name})]}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Contact Person"}),e.jsx("input",{type:"text",className:f("form-control",{"is-invalid":a.touched.contact_person&&a.errors.contact_person}),...a.getFieldProps("contact_person")}),a.touched.contact_person&&a.errors.contact_person&&e.jsx("div",{className:"invalid-feedback",children:a.errors.contact_person})]}),e.jsxs("div",{className:"col-md-12 ",children:[e.jsx(_,{setClass:"mb-3",labelName:"Contact Number",data:a.values.phone,name:"phone",setFieldValue:a.setFieldValue,error:a.errors.phone,touched:a.touched.phone}),a.touched.phone&&a.errors.phone&&e.jsx("div",{className:"invalid-feedback",children:a.errors.phone})]}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Email Address"}),e.jsx("input",{type:"email",placeholder:"e.g. example@email.com",className:f("form-control",{"is-invalid":a.touched.email&&a.errors.email}),...a.getFieldProps("email")}),a.touched.email&&a.errors.email&&e.jsx("div",{className:"invalid-feedback",children:a.errors.email})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})},L=C().shape({name:j().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Supplier name is required"),contact_person:j().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Contact person is required"),phone:j().min(1,"Minimum 1 character").max(30,"Maximum 30 characters").required("Phone number is required"),email:j().email("Invalid email format").max(100,"Maximum 100 characters").required("Email is required")}),$=({supplierId:r,data:t,setRefreshTable:h,onSubmit:n})=>{const{updateSupplier:a}=y(),s=w({initialValues:{name:t.name,contact_person:t.contact_person,phone:t.phone,email:t.email},validationSchema:L,onSubmit:async(x,{resetForm:d})=>{await a(x,r,h),n==null||n(x)}});return e.jsxs("form",{className:"form",noValidate:!0,onSubmit:s.handleSubmit,children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Supplier Name"}),e.jsx("input",{type:"text",className:f("form-control",{"is-invalid":s.touched.name&&s.errors.name}),...s.getFieldProps("name")}),s.touched.name&&typeof s.errors.name=="string"&&e.jsx("div",{className:"invalid-feedback",children:s.errors.name})]}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Contact Person"}),e.jsx("input",{type:"text",className:f("form-control",{"is-invalid":s.touched.contact_person&&s.errors.contact_person}),...s.getFieldProps("contact_person")}),s.touched.phone&&typeof s.errors.phone=="string"&&e.jsx("div",{className:"invalid-feedback",children:s.errors.phone})]}),e.jsxs("div",{className:"col-md-12 ",children:[e.jsx(_,{setClass:"mb-3",labelName:"Contact Number",data:s.values.phone,name:"phone",setFieldValue:s.setFieldValue,error:typeof s.errors.phone=="string"?s.errors.phone:void 0,touched:typeof s.touched.phone=="string"?s.touched.phone:void 0}),s.touched.phone&&typeof s.errors.phone=="string"&&e.jsx("div",{className:"invalid-feedback",children:s.errors.phone})]}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Email Address"}),e.jsx("input",{type:"email",placeholder:"e.g. example@email.com",className:f("form-control",{"is-invalid":s.touched.email&&s.errors.email}),...s.getFieldProps("email")}),s.touched.email&&typeof s.errors.email=="string"&&e.jsx("div",{className:"invalid-feedback",children:s.errors.email})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})},H=({data:r})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Supplier Name"}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:r.name})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Contact Person"}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:r.contact_person})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Contact No."}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:r.phone})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Email Address"}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:r.email})]})]}),I=({data:r,loading:t,pagination:h,sortColumn:n,sortDirection:a,onPageChange:s,onSortChange:x,onEdit:d,onView:o,onArchive:i,onSearchChange:l,setRefreshTable:m})=>{const p=[{title:"#",key:"row_number",sortable:!0},{title:"Name",key:"name",sortable:!0},{title:"Contact Person.",key:"contact_person"},{title:"Contact No.",key:"phone",sortable:!0},{title:"Email Address",key:"email",sortable:!0},{title:"Action",key:"id_encrypted",render:u=>e.jsx(P,{openDetailsModal:()=>o(u.id_encrypted),openEditModal:()=>d(u.id_encrypted),archiveAction:()=>i(u.id_encrypted,m)})}];return e.jsx("div",{className:"table-responsive",children:t?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx(M,{data:r,columns:p,loading:t,pagination:h,sortColumn:n,sortDirection:a,onPageChange:s,onSortChange:x,onSearchChange:l})})},K=({data:r,loading:t,pagination:h,sortColumn:n,sortDirection:a,onPageChange:s,onSortChange:x,onRestore:d,onSearchChange:o,setRefreshTable:i,setRefreshFirstTable:l})=>{const m=[{title:"#",key:"row_number",sortable:!0},{title:"Name",key:"name",sortable:!0},{title:"Contact Person.",key:"contact_person"},{title:"Contact No.",key:"phone",sortable:!0},{title:"Email Address",key:"email",sortable:!0},{title:"Action",key:"id_encrypted",render:p=>e.jsx(P,{restoreAction:()=>d(p.id_encrypted,i,l)})}];return e.jsx("div",{className:"table-responsive",children:t?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx(M,{data:r,columns:m,loading:t,pagination:h,sortColumn:n,sortDirection:a,onPageChange:s,onSortChange:x,onSearchChange:o})})},Y=({onRefreshFirstTable:r})=>{const t=k("/admin/supplier/archived/list"),{restoreSupplier:h}=y();return e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(K,{data:t.data,loading:t.loading,pagination:t.pagination,sortColumn:t.sortColumn,sortDirection:t.sortDirection,onPageChange:t.setPage,onSortChange:(n,a)=>{t.setSortColumn(n),t.setSortDirection(a)},onRestore:h,onSearchChange:n=>{t.setPage(1),t.setSearch(n)},setRefreshTable:t.setRefreshTable,setRefreshFirstTable:r})})})},z=()=>{const r=k("/admin/supplier/list"),{viewSupplierDetails:t,archivedSupplier:h}=y(),[n,a]=q.useState({visible:!1,title:"",body:e.jsx(e.Fragment,{}),className:"modal-xl",alignment:"centered"}),s=()=>{a({visible:!0,title:"Create Supplier",body:e.jsx(B,{setPage:r.setPage}),className:"modal-lg",alignment:"centered"})},x=async i=>{const l=await t(i);l&&a({visible:!0,title:"Edit Supplier",body:e.jsx($,{supplierId:i,data:l,setRefreshTable:r.setRefreshTable}),className:"modal-lg",alignment:"centered"})},d=async i=>{const l=await t(i);l&&a({visible:!0,title:"View Supplier Details",body:e.jsx(H,{data:l}),className:"modal-md",alignment:"centered"})},o=async()=>{a({visible:!0,title:"Archived",body:e.jsx(Y,{onRefreshFirstTable:r.setRefreshTable}),className:"modal-xl",alignment:"centered"})};return e.jsx(e.Fragment,{children:e.jsxs(F,{children:[e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsx("h3",{className:"card-title align-items-start flex-column",children:e.jsx("span",{className:"card-label fw-bold fs-3 mb-1",children:"Supplier"})}),e.jsxs("div",{className:"card-toolbar","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-trigger":"hover",title:"Click to add a user",children:[e.jsxs("button",{onClick:()=>o(),className:"btn btn-sm btn-light-danger me-3",children:[e.jsx(S,{iconName:"delete-files",className:"fs-3"}),"Archived"]}),e.jsxs("button",{onClick:()=>s(),className:"btn btn-sm btn-light-primary",children:[e.jsx(S,{iconName:"plus",className:"fs-3"}),"New Supplier"]})]})]}),e.jsx("div",{className:"card-body py-3",children:e.jsx("div",{className:"table-responsive",children:e.jsx(I,{data:r.data,loading:r.loading,pagination:r.pagination,sortColumn:r.sortColumn,sortDirection:r.sortDirection,onPageChange:r.setPage,onSortChange:(i,l)=>{r.setSortColumn(i),r.setSortDirection(l)},onEdit:x,onView:d,onArchive:h,onSearchChange:i=>{r.setPage(1),r.setSearch(i)},setRefreshTable:r.setRefreshTable})})})]}),n.visible&&e.jsx(E,{title:n.title,body:n.body,modalClass:n.className,alignment:n.alignment,onClose:()=>a({visible:!1,title:"",body:e.jsx(e.Fragment,{}),className:"",alignment:"center"})})]})})},G=[{title:"Supplier List",path:"/supplier/list",isSeparator:!1,isActive:!1}],W=()=>e.jsxs(e.Fragment,{children:[e.jsx(D,{breadcrumbs:G}),e.jsx(z,{})]});export{W as default};
