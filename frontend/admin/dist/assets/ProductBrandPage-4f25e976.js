import{b as V,c as w,S as x,d as A,e as _,m as S,r as B,g as D,j as e,i as k,t as M,n as I,C as L,K as C,P as T}from"./index-04b06589.js";import{M as U}from"./ModalHandler-03d27907.js";import{a as P}from"./apiMultipart-73b930eb.js";import{M as E}from"./MulitpleImageUploader-08105d64.js";import{D as F,A as $}from"./ActionsCell-f1e55298.js";import{I as q}from"./ImageTitleCell-e3aed608.js";const y=()=>{const{showLoader:n,hideLoader:a}=V();return{viewProductBrandDetails:async o=>{var t,r;try{return n(),(await w.get(`/admin/product_brand/${o}/edit`)).data}catch(s){return x.fire({icon:"error",title:(r=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:r.message}),null}finally{a()}},createProductBrand:async(o,t,r,s)=>{var i,d,l,c,b;try{n();const f=new FormData;["name"].forEach(j=>f.append(j,o[j])),o.images.forEach(j=>{f.append("images[]",j)});const N=await P.post("/admin/product_brand/store",f);x.fire({icon:(i=N.data)==null?void 0:i.status,title:(d=N.data)==null?void 0:d.message}),((l=N.data)==null?void 0:l.status)=="success"&&(t(),r==null||r(!0),s==null||s(1))}catch(f){x.fire({icon:"error",title:(b=(c=f==null?void 0:f.response)==null?void 0:c.data)==null?void 0:b.message})}finally{a()}},updateProductBrand:async(o,t,r)=>{var s,i,d,l;try{n();const c=new FormData;["name"].forEach(v=>c.append(v,o[v])),o.images.forEach(v=>{c.append("images[]",v)});const f=await P.post(`/admin/product_brand/${t}/update`,c);x.fire({icon:(s=f.data)==null?void 0:s.status,title:(i=f.data)==null?void 0:i.message}),r==null||r(!0)}catch(c){console.log(c),x.fire({icon:"error",title:(l=(d=c==null?void 0:c.response)==null?void 0:d.data)==null?void 0:l.message})}finally{a()}},archivedProductBrand:async(o,t)=>{var s,i,d,l;if((await x.fire({title:"Are you sure?",text:"This action will archive the item.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, archive it!"})).isConfirmed)try{n();const c=await w.delete(`/admin/product_brand/${o}/delete`);x.fire({icon:((s=c.data)==null?void 0:s.status)||"success",title:(i=c.data)==null?void 0:i.message}),t==null||t(!0)}catch(c){x.fire({icon:"error",title:((l=(d=c==null?void 0:c.response)==null?void 0:d.data)==null?void 0:l.message)||"An error occurred."})}finally{a()}},restoreProductBrand:async(o,t,r)=>{var i,d,l,c;if((await x.fire({title:"Are you sure?",text:"This will restore the archived item.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, restore it!"})).isConfirmed)try{n();const b=await w.post(`/admin/product_brand/${o}/restore`);x.fire({icon:((i=b.data)==null?void 0:i.status)||"success",title:((d=b.data)==null?void 0:d.message)||"Item restored successfully."}),t==null||t(!0),r==null||r(!0)}catch(b){x.fire({icon:"error",title:((c=(l=b==null?void 0:b.response)==null?void 0:l.data)==null?void 0:c.message)||"Something went wrong."})}finally{a()}}}},H=A().shape({name:_().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Brand name is required"),images:S().test("required","Image is required",n=>Array.isArray(n)&&n.length>0)}),K=({setPage:n,setRefreshTable:a,onSubmit:p})=>{const[u,h]=B.useState([]),{createProductBrand:g}=y(),m=D({initialValues:{name:"",images:[]},validationSchema:H,onSubmit:async(o,{resetForm:t})=>{await g(o,t,a,n),p==null||p(o)}});return e.jsxs("form",{noValidate:!0,onSubmit:m.handleSubmit,children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(E,{name:"images",formik:m,previews:u,setPreviews:h,label:"Upload Image",maxFiles:1})}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Brand Name"}),e.jsx("input",{type:"text",className:k("form-control",{"is-invalid":m.touched.name&&m.errors.name}),...m.getFieldProps("name")}),m.touched.name&&m.errors.name&&e.jsx("div",{className:"invalid-feedback",children:m.errors.name})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})},Y=({brandID:n,data:a,setRefreshTable:p,onSubmit:u})=>{const{updateProductBrand:h}=y(),[g,m]=B.useState(a!=null&&a.image_cover?[a.image_cover]:[]),o=A().shape({name:_().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Brand name is required"),images:S().test("images","At least one image required",function(r){return Array.isArray(r)&&r.length>0||g&&g.length>0})}),t=D({initialValues:{name:a.name,images:[]},validationSchema:o,onSubmit:async(r,{resetForm:s})=>{await h(r,n,p),u==null||u(r)}});return e.jsxs("form",{noValidate:!0,onSubmit:t.handleSubmit,children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-12",children:e.jsx(E,{name:"images",formik:t,previews:g,setPreviews:m,label:"Upload Image",maxFiles:1})}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Brand Name"}),e.jsx("input",{type:"text",className:k("form-control",{"is-invalid":t.touched.name&&t.errors.name}),...t.getFieldProps("name")}),t.touched.name&&typeof t.errors.name=="string"&&e.jsx("div",{className:"invalid-feedback",children:t.errors.name})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})},z=({data:n,loading:a,pagination:p,sortColumn:u,sortDirection:h,onPageChange:g,onSortChange:m,onRestore:o,onSearchChange:t,setRefreshTable:r,setRefreshFirstTable:s})=>{const i=[{title:"#",key:"row_number",sortable:!0},{title:"Items",key:"image_cover",render:d=>e.jsx(q,{image:d.image_cover??M("media/default.jpg"),mainTitle:d.name})},{title:"Created At",key:"created_at_format",sortable:!0},{title:"Action",key:"id_encrypted",render:d=>e.jsx($,{restoreAction:()=>o(d.id_encrypted,r,s)})}];return e.jsx("div",{className:"table-responsive",children:a?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx(F,{data:n,columns:i,loading:a,pagination:p,sortColumn:u,sortDirection:h,onPageChange:g,onSortChange:m,onSearchChange:t})})},G=({onRefreshFirstTable:n})=>{const a=I("/admin/product_brand/archived/list"),{restoreProductBrand:p}=y();return e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(z,{data:a.data,loading:a.loading,pagination:a.pagination,sortColumn:a.sortColumn,sortDirection:a.sortDirection,onPageChange:a.setPage,onSortChange:(u,h)=>{a.setSortColumn(u),a.setSortDirection(h)},onRestore:p,onSearchChange:u=>{a.setPage(1),a.setSearch(u)},setRefreshTable:a.setRefreshTable,setRefreshFirstTable:n})})})},J=({data:n,loading:a,pagination:p,sortColumn:u,sortDirection:h,onPageChange:g,onSortChange:m,onEdit:o,onView:t,onArchive:r,onSearchChange:s,setRefreshTable:i})=>{const d=[{title:"#",key:"row_number",sortable:!0},{title:"Items",key:"image_cover",render:l=>e.jsx(q,{image:l.image_cover??M("media/default.jpg"),mainTitle:l.name})},{title:"Created At",key:"created_at_format",sortable:!0},{title:"Action",key:"id_encrypted",render:l=>e.jsx($,{openDetailsModal:()=>t(l.id_encrypted),openEditModal:()=>o(l.id_encrypted),archiveAction:()=>r(l.id_encrypted,i)})}];return e.jsx("div",{className:"table-responsive",children:a?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx(F,{data:n,columns:d,loading:a,pagination:p,sortColumn:u,sortDirection:h,onPageChange:g,onSortChange:m,onSearchChange:s})})},O=({data:n})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Product Brand"}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:n.name})]})}),Q=({title:n})=>{const a=I("/admin/product_brand/list"),{viewProductBrandDetails:p,archivedProductBrand:u}=y(),[h,g]=B.useState({visible:!1,title:"",body:e.jsx(e.Fragment,{}),className:"modal-xl",alignment:"centered"}),m=()=>{g({visible:!0,title:`Create ${n}`,body:e.jsx(K,{setPage:a.setPage,setRefreshTable:a.setRefreshTable}),className:"modal-lg",alignment:"centered"})},o=async s=>{const i=await p(s);i&&g({visible:!0,title:`Edit ${n}`,body:e.jsx(Y,{brandID:s,data:i,setRefreshTable:a.setRefreshTable}),className:"modal-lg",alignment:"centered"})},t=async s=>{const i=await p(s);i&&g({visible:!0,title:`View ${n} Details`,body:e.jsx(O,{data:i}),className:"modal-md",alignment:"centered"})},r=async()=>{g({visible:!0,title:"Archived",body:e.jsx(G,{onRefreshFirstTable:a.setRefreshTable}),className:"modal-xl",alignment:"centered"})};return e.jsx(e.Fragment,{children:e.jsxs(L,{children:[e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsx("h3",{className:"card-title align-items-start flex-column",children:e.jsxs("span",{className:"card-label fw-bold fs-3 mb-1",children:[n,"s"]})}),e.jsxs("div",{className:"card-toolbar","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-trigger":"hover",title:"Click to add a user",children:[e.jsxs("button",{onClick:()=>r(),className:"btn btn-sm btn-light-danger me-3",children:[e.jsx(C,{iconName:"delete-files",className:"fs-3"}),"Archived"]}),e.jsxs("button",{onClick:()=>m(),className:"btn btn-sm btn-light-primary",children:[e.jsx(C,{iconName:"plus",className:"fs-3"}),"New ",n]})]})]}),e.jsx("div",{className:"card-body py-3",children:e.jsx("div",{className:"table-responsive",children:e.jsx(J,{data:a.data,loading:a.loading,pagination:a.pagination,sortColumn:a.sortColumn,sortDirection:a.sortDirection,onPageChange:a.setPage,onSortChange:(s,i)=>{a.setSortColumn(s),a.setSortDirection(i)},onEdit:o,onView:t,onArchive:u,onSearchChange:s=>{a.setPage(1),a.setSearch(s)},setRefreshTable:a.setRefreshTable})})})]}),h.visible&&e.jsx(U,{title:h.title,body:h.body,modalClass:h.className,alignment:h.alignment,onClose:()=>g({visible:!1,title:"",body:e.jsx(e.Fragment,{}),className:"",alignment:"center"})})]})})},W=[{title:"Product Brand",path:"/product/brands/list",isSeparator:!1,isActive:!1}],se=()=>e.jsxs(e.Fragment,{children:[e.jsx(T,{breadcrumbs:W}),e.jsx(Q,{title:"Product Brand"})]});export{se as default};
