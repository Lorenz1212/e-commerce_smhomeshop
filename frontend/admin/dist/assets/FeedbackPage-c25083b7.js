import{j as e,K as w,r as l,c as O,n as V,C as B,P as K}from"./index-04b06589.js";import{D as G,A as H}from"./ActionsCell-f1e55298.js";import{I as U}from"./ImageTitleCell-e3aed608.js";import{S as W}from"./StatusCell-c484659f.js";const q=({data:b,loading:n,pagination:m,sortColumn:u,sortDirection:f,onPageChange:i,onSortChange:p,onView:j,onSearchChange:r,setRefreshTable:N})=>{const d=[{title:"#",key:"row_number",sortable:!0},{title:"Author Name",key:"author_name",sortable:!0,render:a=>e.jsx(U,{mainTitle:a.author_name,subTitle:a.source.name})},{title:"Comment",key:"comment",render:a=>e.jsx(e.Fragment,{children:e.jsx("p",{className:"text-gray-700",children:a.comment.length>80?a.comment.substring(0,80)+"...":a.comment})})},{title:"Rating",key:"rating",render:a=>e.jsx(e.Fragment,{children:Array.from({length:a.rating}).map((o,x)=>e.jsx(w,{iconName:"star",className:"fs-3 me-1 text-warning"},x))})},{title:"Date Posted",key:"date_posted_format",sortable:!0},{title:"Sentiment",key:"sentiment_format",sortable:!0,render:a=>e.jsx(W,{color:a.sentiment_format.color,title:a.sentiment_format.title})},{title:"Action",key:"id",render:a=>e.jsx(H,{openDetailsModal:()=>j(a)})}];return e.jsx("div",{className:"table-responsive",children:n?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx(G,{data:b,columns:d,loading:n,pagination:m,sortColumn:u,sortDirection:f,onPageChange:i,onSortChange:p,onSearchChange:r})})},k=({className:b,color:n,svgIcon:m,iconColor:u,titleColor:f,description:i,descriptionColor:p,url:j,value:r,refreshStat:N})=>{const[d,a]=l.useState(0),o=()=>i.toLowerCase()==="positive"?e.jsx("span",{className:"fs-3x",children:"😊"}):i.toLowerCase()==="negative"?e.jsx("span",{className:"fs-3x",children:"😞"}):i.toLowerCase()==="neutral"?e.jsx("span",{className:"fs-3x",children:"😐"}):e.jsx(w,{iconName:m,className:`text-${u} fs-3x ms-n1`});return l.useEffect(()=>{(async()=>{try{if(r.extraFilter){const h=await O.post(j,r);a(h.data)}}catch(h){console.error("Failed to fetch stats:",h),a(0)}})()},[N]),e.jsx("a",{href:"#",className:`card bg-${n} hoverable ${b} shadow p-3 mb-5 rounded`,children:e.jsxs("div",{className:"card-body",children:[o(),e.jsx("div",{className:`text-${f} fw-bold fs-2 mb-2 mt-5`,children:d}),e.jsx("div",{className:`fw-semibold text-${p}`,children:i})]})})},z=({title:b})=>{const n=new Date,m=new Date(n.getFullYear(),n.getMonth(),1),u=new Date(n.getFullYear(),n.getMonth()+1,0),[f,i]=l.useState(m),[p,j]=l.useState(u),[r,N]=l.useState("daily"),[d,a]=l.useState(n.getMonth()+1),[o,x]=l.useState(n.getFullYear()),[h,I]=l.useState(n.getFullYear()),[C,M]=l.useState(m.toISOString().split("T")[0]),[S,$]=l.useState(u.toISOString().split("T")[0]),[v,A]=l.useState(null),[D,E]=l.useState(0),c=V("/admin/feedback/list",v),[g,T]=l.useState(null),P=t=>{T(t)},Y=()=>{T(null)};l.useEffect(()=>{_()},[]);const _=()=>{let t,s;r==="daily"?(t=new Date(o,d-1,1),s=new Date(o,d,0)):r==="monthly"?(t=new Date(o,0,1),s=new Date(o,11,31)):r==="yearly"?(t=new Date(o,0,1),s=new Date(h,11,31)):(t=new Date(C),s=new Date(S)),i(t),j(s);const y=F=>F.toString().padStart(2,"0"),R=`${t.getFullYear()}-${y(t.getMonth()+1)}-${y(t.getDate())}`,L=`${s.getFullYear()}-${y(s.getMonth()+1)}-${y(s.getDate())}`;A({start_date:R,end_date:L,period:r}),E(F=>F+1)};return e.jsx(e.Fragment,{children:e.jsxs(B,{children:[e.jsxs("div",{className:"row g-5 g-xl-8",children:[e.jsx("div",{className:"col-xxl-4",children:e.jsx(k,{className:"card-xl-stretch mb-5 mb-xl-8",svgIcon:"user-tick",color:"success",iconColor:"white",titleColor:"white",description:"Positive",descriptionColor:"white",url:"/admin/feedback/count",value:{status:"POSITIVE",extraFilter:v},refreshStat:D})}),e.jsx("div",{className:"col-xxl-4",children:e.jsx(k,{className:"card-xl-stretch mb-5 mb-xl-8",svgIcon:"basket-ok",color:"danger",iconColor:"white",titleColor:"white",description:"Negative",descriptionColor:"white",url:"/admin/feedback/count",value:{status:"NEGATIVE",extraFilter:v},refreshStat:D})}),e.jsx("div",{className:"col-xxl-4",children:e.jsx(k,{className:"card-xl-stretch mb-5 mb-xl-8",svgIcon:"abstract-11",color:"primary",iconColor:"white",titleColor:"white",description:"Neutral",descriptionColor:"white",url:"/admin/feedback/count",value:{status:"NEUTRAL",extraFilter:v},refreshStat:D})})]}),e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsx("h3",{className:"card-title align-items-start flex-column",children:e.jsxs("span",{className:"card-label fw-bold fs-3 mb-1",children:[b,"s"]})}),e.jsx("div",{className:"card-toolbar ms-auto d-flex justify-content-end",children:e.jsxs("div",{className:"d-flex align-items-end gap-2 mb-4 flex-row-reverse",children:[e.jsxs("button",{onClick:_,className:"btn btn-xl btn-light-primary d-flex align-items-center gap-2",children:[e.jsx(w,{iconName:"magnifier",className:"fs-3"}),"Filter"]}),r==="date-range"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"date",className:"form-control",value:S,min:C,onChange:t=>$(t.target.value)}),e.jsx("input",{type:"date",className:"form-control",value:C,max:S,onChange:t=>M(t.target.value)})]}),r==="yearly"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"number",className:"form-control",value:h,onChange:t=>I(Number(t.target.value))}),e.jsx("input",{type:"number",className:"form-control",value:o,onChange:t=>x(Number(t.target.value))})]}),r==="monthly"&&e.jsx("input",{type:"number",className:"form-control",value:o,onChange:t=>x(Number(t.target.value))}),r==="daily"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"number",className:"form-control",value:o,onChange:t=>x(Number(t.target.value))}),e.jsx("select",{className:"form-select",value:d,onChange:t=>a(Number(t.target.value)),children:Array.from({length:12},(t,s)=>e.jsx("option",{value:s+1,children:new Date(0,s).toLocaleString("default",{month:"long"})},s+1))})]}),e.jsxs("select",{className:"form-select",value:r,onChange:t=>N(t.target.value),children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"date-range",children:"Date Range"})]})]})})]}),e.jsx("div",{className:"card-body py-3",children:e.jsx("div",{className:"table-responsive",children:e.jsx(q,{data:c.data,loading:c.loading,pagination:c.pagination,sortColumn:c.sortColumn,sortDirection:c.sortDirection,onPageChange:c.setPage,onSortChange:(t,s)=>{c.setSortColumn(t),c.setSortDirection(s)},onView:P,setRefreshTable:c.setRefreshTable})})})]}),g&&e.jsx("div",{className:"modal fade show d-block",tabIndex:-1,role:"dialog",style:{background:"rgba(0,0,0,0.5)"},children:e.jsx("div",{className:"modal-dialog modal-md modal-dialog-centered",role:"document",children:e.jsxs("div",{className:"modal-content border-0 shadow-lg rounded-3",children:[e.jsx("div",{className:"modal-header border-0",children:e.jsx("button",{type:"button",className:"btn-close",onClick:Y})}),e.jsxs("div",{className:"modal-body mb-20 text-center",children:[e.jsx("div",{className:"mb-10 text-warning fw-bold",children:Array.from({length:g.rating}).map((t,s)=>e.jsx(w,{iconName:"star",className:"fs-3 me-1 text-warning"},s))}),e.jsx("p",{className:"text-gray-800",children:g.comment}),e.jsxs("div",{className:"text-muted small mt-10",children:[e.jsx("div",{children:e.jsxs("span",{children:["By ",e.jsx("strong",{children:g.author_name})]})}),e.jsx("div",{children:e.jsxs("span",{className:"ms-3",children:["(",g.source.name,")"]})}),e.jsx("div",{children:e.jsx("span",{className:"ms-3",children:g.date_posted_format})})]})]})]})})})]})})},J=[{title:"Feedbacks",path:"/feedback/list",isSeparator:!1,isActive:!1}],te=()=>e.jsxs(e.Fragment,{children:[e.jsx(K,{breadcrumbs:J}),e.jsx(z,{title:"Feedback"})]});export{te as default};
