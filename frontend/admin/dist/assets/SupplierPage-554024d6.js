import{b as q,c as g,S as b,d as w,e as j,g as _,j as e,i as f,a as S,n as k,r as F,C as D,K as C,P as E}from"./index-47a86244.js";import{M as V}from"./ModalHandler-ad0ee9b4.js";import{P as A}from"./phoneNumber-73030602.js";import{D as M,A as P}from"./ActionsCell-25d0eec8.js";const y=()=>{const{showLoader:n,hideLoader:r}=q();return{viewSupplierDetails:async h=>{var m,c;try{return n(),(await g.get(`/admin/supplier/${h}/edit`)).data}catch(d){return b.fire({icon:"error",title:(c=(m=d==null?void 0:d.response)==null?void 0:m.data)==null?void 0:c.message}),null}finally{r()}},createSupplier:async(h,m,c,d)=>{var i,l,u,o,v;try{n();const N=await g.post("/admin/supplier/store",h);b.fire({icon:(i=N.data)==null?void 0:i.status,title:(l=N.data)==null?void 0:l.message}),((u=N.data)==null?void 0:u.status)=="success"&&(m(),c==null||c(!0),d==null||d(1))}catch(N){b.fire({icon:"error",title:(v=(o=N==null?void 0:N.response)==null?void 0:o.data)==null?void 0:v.message})}finally{r()}},updateSupplier:async(h,m,c)=>{var d,i,l,u;try{n();const o=await g.put(`/admin/supplier/${m}/update`,h);b.fire({icon:(d=o.data)==null?void 0:d.status,title:(i=o.data)==null?void 0:i.message}),c==null||c(!0)}catch(o){console.log(o),b.fire({icon:"error",title:(u=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:u.message})}finally{r()}},archivedSupplier:async(h,m)=>{var d,i,l,u;if((await b.fire({title:"Are you sure?",text:"This action will archive the supplier.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, archive it!"})).isConfirmed)try{n();const o=await g.delete(`/admin/supplier/${h}/delete`);b.fire({icon:((d=o.data)==null?void 0:d.status)||"success",title:((i=o.data)==null?void 0:i.message)||"Supplier archived successfully."}),m==null||m(!0)}catch(o){b.fire({icon:"error",title:((u=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:u.message)||"An error occurred."})}finally{r()}},restoreSupplier:async(h,m,c)=>{var i,l,u,o;if((await b.fire({title:"Are you sure?",text:"This will restore the archived supplier.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, restore it!"})).isConfirmed)try{n();const v=await g.post(`/admin/supplier/${h}/restore`);b.fire({icon:((i=v.data)==null?void 0:i.status)||"success",title:((l=v.data)==null?void 0:l.message)||"Supplier restored successfully."}),m==null||m(!0),c==null||c(!0)}catch(v){b.fire({icon:"error",title:((o=(u=v==null?void 0:v.response)==null?void 0:u.data)==null?void 0:o.message)||"Something went wrong."})}finally{r()}}}},B=w().shape({name:j().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Supplier name is required"),contact_person:j().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Contact person is required"),phone:j().min(1,"Minimum 1 character").max(30,"Maximum 30 characters").required("Phone number is required"),email:j().email("Invalid email format").max(100,"Maximum 100 characters").required("Email is required")}),L=({setPage:n,setRefreshTable:r,onSubmit:t})=>{const{createSupplier:p}=y(),a=_({initialValues:{name:"",contact_person:"",phone:"",email:""},validationSchema:B,onSubmit:async(s,{resetForm:x})=>{await p(s,x,r,n),t==null||t(s)}});return e.jsxs("form",{className:"form",noValidate:!0,onSubmit:a.handleSubmit,children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Supplier Name"}),e.jsx("input",{type:"text",className:f("form-control",{"is-invalid":a.touched.name&&a.errors.name}),...a.getFieldProps("name")}),a.touched.name&&a.errors.name&&e.jsx("div",{className:"invalid-feedback",children:a.errors.name})]}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Contact Person"}),e.jsx("input",{type:"text",className:f("form-control",{"is-invalid":a.touched.contact_person&&a.errors.contact_person}),...a.getFieldProps("contact_person")}),a.touched.contact_person&&a.errors.contact_person&&e.jsx("div",{className:"invalid-feedback",children:a.errors.contact_person})]}),e.jsxs("div",{className:"col-md-12 ",children:[e.jsx(A,{setClass:"mb-3",labelName:"Contact Number",data:a.values.phone,name:"phone",setFieldValue:a.setFieldValue,error:a.errors.phone,touched:a.touched.phone}),a.touched.phone&&a.errors.phone&&e.jsx("div",{className:"invalid-feedback",children:a.errors.phone})]}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Email Address"}),e.jsx("input",{type:"email",placeholder:"e.g. example@email.com",className:f("form-control",{"is-invalid":a.touched.email&&a.errors.email}),...a.getFieldProps("email")}),a.touched.email&&a.errors.email&&e.jsx("div",{className:"invalid-feedback",children:a.errors.email})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})},$=w().shape({name:j().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Supplier name is required"),contact_person:j().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Contact person is required"),phone:j().min(1,"Minimum 1 character").max(30,"Maximum 30 characters").required("Phone number is required"),email:j().email("Invalid email format").max(100,"Maximum 100 characters").required("Email is required")}),H=({supplierId:n,data:r,setRefreshTable:t,onSubmit:p})=>{const{updateSupplier:a}=y(),s=_({initialValues:{name:r.name,contact_person:r.contact_person,phone:r.phone,email:r.email},validationSchema:$,onSubmit:async(x,{resetForm:h})=>{await a(x,n,t),p==null||p(x)}});return e.jsxs("form",{className:"form",noValidate:!0,onSubmit:s.handleSubmit,children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Supplier Name"}),e.jsx("input",{type:"text",className:f("form-control",{"is-invalid":s.touched.name&&s.errors.name}),...s.getFieldProps("name")}),s.touched.name&&typeof s.errors.name=="string"&&e.jsx("div",{className:"invalid-feedback",children:s.errors.name})]}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Contact Person"}),e.jsx("input",{type:"text",className:f("form-control",{"is-invalid":s.touched.contact_person&&s.errors.contact_person}),...s.getFieldProps("contact_person")}),s.touched.phone&&typeof s.errors.phone=="string"&&e.jsx("div",{className:"invalid-feedback",children:s.errors.phone})]}),e.jsxs("div",{className:"col-md-12 ",children:[e.jsx(A,{setClass:"mb-3",labelName:"Contact Number",data:s.values.phone,name:"phone",setFieldValue:s.setFieldValue,error:typeof s.errors.phone=="string"?s.errors.phone:void 0,touched:typeof s.touched.phone=="string"?s.touched.phone:void 0}),s.touched.phone&&typeof s.errors.phone=="string"&&e.jsx("div",{className:"invalid-feedback",children:s.errors.phone})]}),e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Email Address"}),e.jsx("input",{type:"email",placeholder:"e.g. example@email.com",className:f("form-control",{"is-invalid":s.touched.email&&s.errors.email}),...s.getFieldProps("email")}),s.touched.email&&typeof s.errors.email=="string"&&e.jsx("div",{className:"invalid-feedback",children:s.errors.email})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})},I=({data:n})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Supplier Name"}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:n.name})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Contact Person"}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:n.contact_person})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Contact No."}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:n.phone})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Email Address"}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:n.email})]})]}),K=({data:n,loading:r,pagination:t,sortColumn:p,sortDirection:a,onPageChange:s,onSortChange:x,onEdit:h,onView:m,onArchive:c,onSearchChange:d,setRefreshTable:i})=>{const{currentUser:l}=S(),u=l==null?void 0:l.permissions,o=[{title:"#",key:"row_number",sortable:!0},{title:"Name",key:"name",sortable:!0},{title:"Contact Person.",key:"contact_person"},{title:"Contact No.",key:"phone",sortable:!0},{title:"Email Address",key:"email",sortable:!0},{title:"Action",key:"id_encrypted",render:v=>e.jsx(P,{openDetailsModal:u.includes("view_supplier_details")?()=>m(v.id_encrypted):void 0,openEditModal:u.includes("update_supplier")?()=>h(v.id_encrypted):void 0,archiveAction:u.includes("archived_supplier")?()=>c(v.id_encrypted,i):void 0})}];return e.jsx("div",{className:"table-responsive",children:r?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx(M,{data:n,columns:o,loading:r,pagination:t,sortColumn:p,sortDirection:a,onPageChange:s,onSortChange:x,onSearchChange:d})})},Y=({data:n,loading:r,pagination:t,sortColumn:p,sortDirection:a,onPageChange:s,onSortChange:x,onRestore:h,onSearchChange:m,setRefreshTable:c,setRefreshFirstTable:d})=>{const{currentUser:i}=S(),l=i==null?void 0:i.permissions,u=[{title:"#",key:"row_number",sortable:!0},{title:"Name",key:"name",sortable:!0},{title:"Contact Person.",key:"contact_person"},{title:"Contact No.",key:"phone",sortable:!0},{title:"Email Address",key:"email",sortable:!0},{title:"Action",key:"id_encrypted",render:o=>e.jsx(P,{restoreAction:l.includes("restore_supplier")?()=>h(o.id_encrypted,c,d):void 0})}];return e.jsx("div",{className:"table-responsive",children:r?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx(M,{data:n,columns:u,loading:r,pagination:t,sortColumn:p,sortDirection:a,onPageChange:s,onSortChange:x,onSearchChange:m})})},z=({onRefreshFirstTable:n})=>{const r=k("/admin/supplier/archived/list"),{restoreSupplier:t}=y();return e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(Y,{data:r.data,loading:r.loading,pagination:r.pagination,sortColumn:r.sortColumn,sortDirection:r.sortDirection,onPageChange:r.setPage,onSortChange:(p,a)=>{r.setSortColumn(p),r.setSortDirection(a)},onRestore:t,onSearchChange:p=>{r.setPage(1),r.setSearch(p)},setRefreshTable:r.setRefreshTable,setRefreshFirstTable:n})})})},G=()=>{const{currentUser:n}=S(),r=n==null?void 0:n.permissions,t=k("/admin/supplier/list"),{viewSupplierDetails:p,archivedSupplier:a}=y(),[s,x]=F.useState({visible:!1,title:"",body:e.jsx(e.Fragment,{}),className:"modal-xl",alignment:"centered"}),h=()=>{x({visible:!0,title:"Create Supplier",body:e.jsx(L,{setPage:t.setPage}),className:"modal-lg",alignment:"centered"})},m=async i=>{const l=await p(i);l&&x({visible:!0,title:"Edit Supplier",body:e.jsx(H,{supplierId:i,data:l,setRefreshTable:t.setRefreshTable}),className:"modal-lg",alignment:"centered"})},c=async i=>{const l=await p(i);l&&x({visible:!0,title:"View Supplier Details",body:e.jsx(I,{data:l}),className:"modal-md",alignment:"centered"})},d=async()=>{x({visible:!0,title:"Archived",body:e.jsx(z,{onRefreshFirstTable:t.setRefreshTable}),className:"modal-xl",alignment:"centered"})};return e.jsx(e.Fragment,{children:e.jsxs(D,{children:[e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsx("h3",{className:"card-title align-items-start flex-column",children:e.jsx("span",{className:"card-label fw-bold fs-3 mb-1",children:"Supplier"})}),e.jsxs("div",{className:"card-toolbar","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-trigger":"hover",title:"Click to add a user",children:[r.includes("archived_product")&&e.jsxs("button",{onClick:()=>d(),className:"btn btn-sm btn-light-danger me-3",children:[e.jsx(C,{iconName:"delete-files",className:"fs-3"}),"Archived"]}),r.includes("create_product")&&e.jsxs("button",{onClick:()=>h(),className:"btn btn-sm btn-light-primary",children:[e.jsx(C,{iconName:"plus",className:"fs-3"}),"New Supplier"]})]})]}),e.jsx("div",{className:"card-body py-3",children:e.jsx("div",{className:"table-responsive",children:e.jsx(K,{data:t.data,loading:t.loading,pagination:t.pagination,sortColumn:t.sortColumn,sortDirection:t.sortDirection,onPageChange:t.setPage,onSortChange:(i,l)=>{t.setSortColumn(i),t.setSortDirection(l)},onEdit:m,onView:c,onArchive:a,onSearchChange:i=>{t.setPage(1),t.setSearch(i)},setRefreshTable:t.setRefreshTable})})})]}),s.visible&&e.jsx(V,{title:s.title,body:s.body,modalClass:s.className,alignment:s.alignment,onClose:()=>x({visible:!1,title:"",body:e.jsx(e.Fragment,{}),className:"",alignment:"center"})})]})})},J=[{title:"Supplier List",path:"/supplier/list",isSeparator:!1,isActive:!1}],Z=()=>e.jsxs(e.Fragment,{children:[e.jsx(E,{breadcrumbs:J}),e.jsx(G,{})]});export{Z as default};
