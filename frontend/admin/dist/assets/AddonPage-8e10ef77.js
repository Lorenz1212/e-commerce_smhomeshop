import{b as D,c as y,S as p,j as e,d as w,e as N,o as C,g as k,i as g,n as P,r as Y,C as B,K as _,P as q}from"./index-47a86244.js";import{M}from"./ModalHandler-ad0ee9b4.js";import{a as A}from"./apiMultipart-5aee4e22.js";import{D as F,A as S}from"./ActionsCell-25d0eec8.js";const v=()=>{const{showLoader:s,hideLoader:a}=D();return{viewAddonDetails:async c=>{var o,r;try{return s(),(await y.get(`/admin/addon/${c}/edit`)).data}catch(i){return p.fire({icon:"error",title:(r=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:r.message}),null}finally{a()}},createAddon:async(c,o,r,i)=>{var h,m,u,l,f;try{s();const j=await A.post("/admin/addon/store",c);p.fire({icon:(h=j.data)==null?void 0:h.status,title:(m=j.data)==null?void 0:m.message}),((u=j.data)==null?void 0:u.status)=="success"&&(o(),r==null||r(!0),i==null||i(1))}catch(j){p.fire({icon:"error",title:(f=(l=j==null?void 0:j.response)==null?void 0:l.data)==null?void 0:f.message})}finally{a()}},updateAddon:async(c,o,r)=>{var i,h,m,u;try{s();const l=await A.post(`/admin/addon/${o}/update`,c);p.fire({icon:(i=l.data)==null?void 0:i.status,title:(h=l.data)==null?void 0:h.message}),r==null||r(!0)}catch(l){console.log(l),p.fire({icon:"error",title:(u=(m=l==null?void 0:l.response)==null?void 0:m.data)==null?void 0:u.message})}finally{a()}},archivedAddon:async(c,o)=>{var i,h,m,u;if((await p.fire({title:"Are you sure?",text:"This action will archive the item.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, archive it!"})).isConfirmed)try{s();const l=await y.delete(`/admin/addon/${c}/archive`);p.fire({icon:((i=l.data)==null?void 0:i.status)||"success",title:(h=l.data)==null?void 0:h.message}),o==null||o(!0)}catch(l){p.fire({icon:"error",title:((u=(m=l==null?void 0:l.response)==null?void 0:m.data)==null?void 0:u.message)||"An error occurred."})}finally{a()}},restoreAddon:async(c,o,r)=>{var h,m,u,l;if((await p.fire({title:"Are you sure?",text:"This will restore the archived item.",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#6c757d",confirmButtonText:"Yes, restore it!"})).isConfirmed)try{s();const f=await y.post(`/admin/addon/${c}/restore`);p.fire({icon:((h=f.data)==null?void 0:h.status)||"success",title:((m=f.data)==null?void 0:m.message)||"Item restored successfully."}),o==null||o(!0),r==null||r(!0)}catch(f){p.fire({icon:"error",title:((l=(u=f==null?void 0:f.response)==null?void 0:u.data)==null?void 0:l.message)||"Something went wrong."})}finally{a()}}}},V=({data:s})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-sm-4 text-muted",children:"Product Category"}),e.jsx("div",{className:"col-sm-8 fw-semibold",children:s.name})]})}),E=w().shape({name:N().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Add-ons name is required"),base_price:C().when("is_freebies",{is:"N",then:s=>s.required("Base price is required").min(1),otherwise:s=>s.notRequired().nullable()}),is_freebies:N().oneOf(["Y","N"]).required()}),L=({setPage:s,setRefreshTable:a,onSubmit:b})=>{const{createAddon:d}=v(),t=k({initialValues:{name:"",base_price:"",is_freebies:"N"},validationSchema:E,onSubmit:async(x,{resetForm:n})=>{await d(x,n,a,s),b==null||b(x)}});return e.jsxs("form",{className:"form",noValidate:!0,onSubmit:t.handleSubmit,children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Add-on Name"}),e.jsx("input",{type:"text",className:g("form-control",{"is-invalid":t.touched.name&&t.errors.name}),...t.getFieldProps("name")}),t.touched.name&&t.errors.name&&e.jsx("div",{className:"invalid-feedback",children:t.errors.name})]}),e.jsxs("div",{className:"col-md-12 mb-3 d-flex align-items-center",children:[e.jsx("label",{className:"form-label me-3 mb-0",children:"Is Freebie?"}),e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:"is_freebies",checked:t.values.is_freebies==="Y",onChange:x=>t.setFieldValue("is_freebies",x.target.checked?"Y":"N")}),e.jsx("label",{className:"form-check-label",htmlFor:"is_freebies",children:t.values.is_freebies==="Y"?"Yes":"No"})]})]}),t.values.is_freebies==="N"&&e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Cost Price"}),e.jsx("input",{type:"number",className:g("form-control",{"is-invalid":t.touched.base_price&&t.errors.base_price}),...t.getFieldProps("base_price")}),t.touched.base_price&&t.errors.base_price&&e.jsx("div",{className:"invalid-feedback",children:t.errors.base_price})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})},$=({categoryID:s,data:a,setRefreshTable:b,onSubmit:d})=>{const{updateAddon:t}=v(),x=w().shape({name:N().min(1,"Minimum 1 character").max(50,"Maximum 50 characters").required("Add-ons name is required"),base_price:C().when("is_freebies",{is:"N",then:c=>c.required("Base price is required").min(1),otherwise:c=>c.notRequired().nullable()}),is_freebies:N().oneOf(["Y","N"]).required()}),n=k({initialValues:{name:a.name,base_price:a.base_price,is_freebies:a.is_freebies??"N"},validationSchema:x,onSubmit:async(c,{resetForm:o})=>{const r={...c,base_price:c.is_freebies==="Y"?0:c.base_price};await t(r,s,b),d==null||d(r)}});return e.jsxs("form",{className:"form",noValidate:!0,onSubmit:n.handleSubmit,children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Product Add-on"}),e.jsx("input",{type:"text",className:g("form-control",{"is-invalid":n.touched.name&&n.errors.name}),...n.getFieldProps("name")}),n.touched.name&&typeof n.errors.name=="string"&&e.jsx("div",{className:"invalid-feedback",children:n.errors.name})]}),e.jsxs("div",{className:"col-md-12 mb-3 d-flex align-items-center",children:[e.jsx("label",{className:"form-label me-3 mb-0",children:"Is Freebie?"}),e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",id:"is_freebies",checked:n.values.is_freebies==="Y",onChange:c=>n.setFieldValue("is_freebies",c.target.checked?"Y":"N")}),e.jsx("label",{className:"form-check-label",htmlFor:"is_freebies",children:n.values.is_freebies==="Y"?"Yes":"No"})]})]}),n.values.is_freebies==="N"&&e.jsxs("div",{className:"col-md-12 mb-3",children:[e.jsx("label",{className:"form-label",children:"Base Price"}),e.jsx("input",{type:"number",className:g("form-control",{"is-invalid":n.touched.base_price&&n.errors.base_price}),...n.getFieldProps("base_price")}),n.touched.base_price&&typeof n.errors.base_price=="string"&&e.jsx("div",{className:"invalid-feedback",children:n.errors.base_price})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-4",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})},I=({data:s,loading:a,pagination:b,sortColumn:d,sortDirection:t,onPageChange:x,onSortChange:n,onEdit:c,onView:o,onArchive:r,onSearchChange:i,setRefreshTable:h})=>{const m=[{title:"#",key:"row_number",sortable:!0},{title:"Name",key:"name",sortable:!0},{title:"Base Price",key:"base_price",sortable:!0,render:u=>e.jsx(e.Fragment,{children:u.is_freebies=="Y"?e.jsx(e.Fragment,{children:e.jsx("span",{className:"text-success",children:"Freebie"})}):u.base_price})},{title:"Created At",key:"created_at_format",sortable:!0},{title:"Action",key:"id_encrypted",render:u=>e.jsx(S,{openDetailsModal:()=>o(u.id_encrypted),openEditModal:()=>c(u.id_encrypted),archiveAction:()=>r(u.id_encrypted,h)})}];return e.jsx("div",{className:"table-responsive",children:a?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx(F,{data:s,columns:m,loading:a,pagination:b,sortColumn:d,sortDirection:t,onPageChange:x,onSortChange:n,onSearchChange:i})})},H=({data:s,loading:a,pagination:b,sortColumn:d,sortDirection:t,onPageChange:x,onSortChange:n,onRestore:c,onSearchChange:o,setRefreshTable:r,setRefreshFirstTable:i})=>{const h=[{title:"#",key:"row_number",sortable:!0},{title:"Name",key:"name",sortable:!0},{title:"Base Price",key:"base_price",sortable:!0,render:m=>e.jsx(e.Fragment,{children:m.is_freebies=="Y"?e.jsx(e.Fragment,{children:e.jsx("span",{className:"text-success",children:"Freebie"})}):m.base_price})},{title:"Created At",key:"created_at_format",sortable:!0},{title:"Action",key:"id_encrypted",render:m=>e.jsx(S,{restoreAction:()=>c(m.id_encrypted,r,i)})}];return e.jsx("div",{className:"table-responsive",children:a?e.jsx("div",{className:"alert alert-info",children:"Loading..."}):e.jsx(F,{data:s,columns:h,loading:a,pagination:b,sortColumn:d,sortDirection:t,onPageChange:x,onSortChange:n,onSearchChange:o})})},K=({onRefreshFirstTable:s})=>{const a=P("/admin/addon/archived/list"),{restoreAddon:b}=v();return e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx(H,{data:a.data,loading:a.loading,pagination:a.pagination,sortColumn:a.sortColumn,sortDirection:a.sortDirection,onPageChange:a.setPage,onSortChange:(d,t)=>{a.setSortColumn(d),a.setSortDirection(t)},onRestore:b,onSearchChange:d=>{a.setPage(1),a.setSearch(d)},setRefreshTable:a.setRefreshTable,setRefreshFirstTable:s})})})},O=()=>{const s=P("/admin/addon/list"),{viewAddonDetails:a,archivedAddon:b}=v(),[d,t]=Y.useState({visible:!1,title:"",body:e.jsx(e.Fragment,{}),className:"modal-xl",alignment:"centered"}),x=()=>{t({visible:!0,title:"Create Product Add-ons",body:e.jsx(L,{setPage:s.setPage,setRefreshTable:s.setRefreshTable}),className:"modal-lg",alignment:"centered"})},n=async r=>{const i=await a(r);i&&t({visible:!0,title:"Edit Product Add-ons",body:e.jsx($,{categoryID:r,data:i,setRefreshTable:s.setRefreshTable}),className:"modal-lg",alignment:"centered"})},c=async r=>{const i=await a(r);i&&t({visible:!0,title:"View Product Add-ons Details",body:e.jsx(V,{data:i}),className:"modal-md",alignment:"centered"})},o=async()=>{t({visible:!0,title:"Archived",body:e.jsx(K,{onRefreshFirstTable:s.setRefreshTable}),className:"modal-xl",alignment:"centered"})};return e.jsx(e.Fragment,{children:e.jsxs(B,{children:[e.jsxs("div",{className:"card mb-5 mb-xl-8",children:[e.jsxs("div",{className:"card-header border-0 pt-5",children:[e.jsx("h3",{className:"card-title align-items-start flex-column",children:e.jsx("span",{className:"card-label fw-bold fs-3 mb-1",children:"Product Add-ons"})}),e.jsxs("div",{className:"card-toolbar","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-trigger":"hover",title:"Click to add a user",children:[e.jsxs("button",{onClick:()=>o(),className:"btn btn-sm btn-light-danger me-3",children:[e.jsx(_,{iconName:"delete-files",className:"fs-3"}),"Archived"]}),e.jsxs("button",{onClick:()=>x(),className:"btn btn-sm btn-light-primary",children:[e.jsx(_,{iconName:"plus",className:"fs-3"}),"New Add-ons"]})]})]}),e.jsx("div",{className:"card-body py-3",children:e.jsx("div",{className:"table-responsive",children:e.jsx(I,{data:s.data,loading:s.loading,pagination:s.pagination,sortColumn:s.sortColumn,sortDirection:s.sortDirection,onPageChange:s.setPage,onSortChange:(r,i)=>{s.setSortColumn(r),s.setSortDirection(i)},onEdit:n,onView:c,onArchive:b,onSearchChange:r=>{s.setPage(1),s.setSearch(r)},setRefreshTable:s.setRefreshTable})})})]}),d.visible&&e.jsx(M,{title:d.title,body:d.body,modalClass:d.className,alignment:d.alignment,onClose:()=>t({visible:!1,title:"",body:e.jsx(e.Fragment,{}),className:"",alignment:"center"})})]})})},T=[{title:"Product Add-ons",path:"/product/addon/list",isSeparator:!1,isActive:!1}],U=()=>e.jsxs(e.Fragment,{children:[e.jsx(q,{breadcrumbs:T}),e.jsx(O,{})]});export{U as default};
